# backend/update_rooms.py
import sqlite3

DB_PATH = 'school21.db'

def update_rooms():
    conn = sqlite3.connect(DB_PATH)
    cursor = conn.cursor()
    
    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
        cursor.execute("SELECT name FROM sqlite_master WHERE type='table' AND name='rooms'")
        if not cursor.fetchone():
            print("–¢–∞–±–ª–∏—Ü–∞ rooms –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ database.py –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.")
            return
        
        # –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –∫–æ–º–Ω–∞—Ç—ã –Ω–∞ 3 —ç—Ç–∞–∂–µ
        cursor.execute("DELETE FROM rooms WHERE floor = 3")
        print("–£–¥–∞–ª–µ–Ω—ã —Å—Ç–∞—Ä—ã–µ –∫–æ–º–Ω–∞—Ç—ã 3 —ç—Ç–∞–∂–∞")
        
        # –î–æ–±–∞–≤–ª—è–µ–º 6 —Å–∫–∞–π–ø–Ω–∏—Ü –∏ 3 –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∫–∏ –Ω–∞ 3 —ç—Ç–∞–∂
        floor3_rooms = [
            # –°–∫–∞–π–ø–Ω–∏—Ü—ã 3 —ç—Ç–∞–∂–∞ (6 —à—Ç—É–∫) - 7 –∫–æ–∏–Ω–æ–≤
            ("–°–∫–∞–π–ø–Ω–∏—Ü–∞ 1", "skypbox", 3, 7, 
             "–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å 4 —á–µ–ª–æ–≤–µ–∫–∞ üîä\n–ü–æ–ª–Ω–∞—è —à—É–º–æ–∏–∑–æ–ª—è—Ü–∏—è üéß\n–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–∞–±–∏–Ω–∫–∞ –Ω–∞ 3 —ç—Ç–∞–∂–µ\n–¢–∏—Ö–∞—è –∑–æ–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã", 
             "assets/skype_room.jpg", 4),
            
            ("–°–∫–∞–π–ø–Ω–∏—Ü–∞ 2", "skypbox", 3, 7, 
             "–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å 4 —á–µ–ª–æ–≤–µ–∫–∞ üîä\n–ü–æ–ª–Ω–∞—è —à—É–º–æ–∏–∑–æ–ª—è—Ü–∏—è üéß\n–£—é—Ç–Ω–∞—è —Ä–∞–±–æ—á–∞—è –∑–æ–Ω–∞\n–î–ª—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã", 
             "assets/skype_room.jpg", 4),
            
            ("–°–∫–∞–π–ø–Ω–∏—Ü–∞ 3", "skypbox", 3, 7, 
             "–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å 4 —á–µ–ª–æ–≤–µ–∫–∞ üîä\n–ü–æ–ª–Ω–∞—è —à—É–º–æ–∏–∑–æ–ª—è—Ü–∏—è üéß\n–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ\n–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –∏–Ω—Ç–µ—Ä–≤—å—é", 
             "assets/skype_room.jpg", 4),
            
            ("–°–∫–∞–π–ø–Ω–∏—Ü–∞ 4", "skypbox", 3, 7, 
             "–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å 4 —á–µ–ª–æ–≤–µ–∫–∞ üîä\n–ü–æ–ª–Ω–∞—è —à—É–º–æ–∏–∑–æ–ª—è—Ü–∏—è üéß\n–ö–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è –∫–∞–±–∏–Ω–∫–∞\n–î–ª—è –≤–∞–∂–Ω—ã—Ö –∑–≤–æ–Ω–∫–æ–≤", 
             "assets/skype_room.jpg", 4),
            
            ("–°–∫–∞–π–ø–Ω–∏—Ü–∞ 5", "skypbox", 3, 7, 
             "–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å 4 —á–µ–ª–æ–≤–µ–∫–∞ üîä\n–ü–æ–ª–Ω–∞—è —à—É–º–æ–∏–∑–æ–ª—è—Ü–∏—è üéß\n–£–µ–¥–∏–Ω–µ–Ω–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ\n–•–æ—Ä–æ—à–µ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ", 
             "assets/skype_room.jpg", 4),
            
            ("–°–∫–∞–π–ø–Ω–∏—Ü–∞ 6", "skypbox", 3, 7, 
             "–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å 4 —á–µ–ª–æ–≤–µ–∫–∞ üîä\n–ü–æ–ª–Ω–∞—è —à—É–º–æ–∏–∑–æ–ª—è—Ü–∏—è üéß\n–¢–∏—Ö–∞—è —Ä–∞–±–æ—á–∞—è –∑–æ–Ω–∞\n–û—Å–Ω–∞—â–µ–Ω–∞ —Ä–æ–∑–µ—Ç–∫–∞–º–∏ –∏ USB", 
             "assets/skype_room.jpg", 4),
            
            # –ü–µ—Ä–µ–≥–æ–≤–æ—Ä–∫–∏ 3 —ç—Ç–∞–∂–∞ (3 —à—Ç—É–∫–∏) - 12 –∫–æ–∏–Ω–æ–≤
            ("–ü–µ—Ä–µ–≥–æ–≤–æ—Ä–∫–∞ 1", "meeting", 3, 12, 
             "–ö–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞ üíº\n–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –¥–æ 8 —á–µ–ª–æ–≤–µ–∫\n–ü—Ä–æ–µ–∫—Ç–æ—Ä –∏ –¥–æ—Å–∫–∞ –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π\n–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –≤—Å—Ç—Ä–µ—á –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–π", 
             "assets/meeting_room.jpg", 8),
            
            ("–ü–µ—Ä–µ–≥–æ–≤–æ—Ä–∫–∞ 2", "meeting", 3, 12, 
             "–ö–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞ üíº\n–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –¥–æ 8 —á–µ–ª–æ–≤–µ–∫\n–ü—Ä–æ–µ–∫—Ç–æ—Ä –∏ –¥–æ—Å–∫–∞ –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π\n–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –≤—Å—Ç—Ä–µ—á –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–π", 
             "assets/meeting_room.jpg", 8),
            
            ("–ü–µ—Ä–µ–≥–æ–≤–æ—Ä–∫–∞ 3", "meeting", 3, 12, 
             "–ö–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞ üíº\n–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –¥–æ 8 —á–µ–ª–æ–≤–µ–∫\n–ü—Ä–æ–µ–∫—Ç–æ—Ä –∏ –¥–æ—Å–∫–∞ –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π\n–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –≤—Å—Ç—Ä–µ—á –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–π", 
             "assets/meeting_room.jpg", 8),
        ]
        
        cursor.executemany(
            "INSERT INTO rooms (name, type, floor, price, description, photo_url, max_persons) VALUES (?, ?, ?, ?, ?, ?, ?)",
            floor3_rooms
        )
        
        conn.commit()
        print("–ö–æ–º–Ω–∞—Ç—ã 3 —ç—Ç–∞–∂–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!")
        print("3 —ç—Ç–∞–∂: 6 —Å–∫–∞–π–ø–Ω–∏—Ü –ø–æ 7 –∫–æ–∏–Ω–æ–≤/—á–∞—Å")
        print("3 —ç—Ç–∞–∂: 3 –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∫–∏ –ø–æ 12 –∫–æ–∏–Ω–æ–≤/—á–∞—Å")
        
    except Exception as e:
        conn.rollback()
        print(f"–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: {e}")
        raise
    finally:
        conn.close()

if __name__ == '__main__':
    update_rooms()